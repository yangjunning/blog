---
title: å‰ç«¯è§„èŒƒåŒ–å¼€å‘å®è·µ
date: 2020-03-24 22:53:11
tags:
---

![](https://i.loli.net/2020/03/24/EKCvkLJZNtfBrpu.png)

<!--more-->

æœ¬æ–‡ä»¥ React Native é¡¹ç›®ä¸ºç¤ºä¾‹ä»‹ç»äº†å‰ç«¯è§„èŒƒåŒ–å¼€å‘æ¶‰åŠçš„å·¥å…·åŠçŸ¥è¯†ï¼Œä½†æ˜¯æ‰€æ¶‰åŠå†…å®¹å…·æœ‰é€šç”¨æ€§ï¼Œå»ºè®®è¯»è€…ç‚¹èµæ”¶è—(*^â–½^*)ã€‚

> å¦å¤–å®‰åˆ©ä¸€ä¸‹ [@sigmayun/react-native-template-typescript](https://github.com/sigmayun/react-native-template-typescript)ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº typescript çš„ react native å¼€ç®±å³ç”¨çš„æ¨¡æ¿ã€‚æœ¬æ–‡æ‰€æ¶‰åŠçš„å¤§éƒ¨åˆ†å†…å®¹éƒ½é›†æˆåˆ°äº†è¯¥æ¨¡æ¿ä¸­ã€‚

## gitconfig

```sh
# åˆå§‹åŒ–è®¾ç½®
$ git config --global user.name 'your_name'
$ git config --global user.email 'your_email@aliyun.com'
# æé«˜å‘½ä»¤è¾“å‡ºçš„å¯è¯»æ€§
$ git config --global color.ui auto
# git è®°ä½ç”¨æˆ·åå’Œå¯†ç 
$ git config --global credential.helper store
# core.autocrlf
$ git config --global core.autocrlf input
```

ä»¥ä¸Šé…ç½®å†…å®¹å¯ä»¥åœ¨ `~/.gitconfig` æ–‡ä»¶ä¸­æ‰¾åˆ°ã€‚

## npm scripts

`package.json` æ–‡ä»¶çš„ scripts å­—æ®µæ˜¯å®šä¹‰å¯æ‰§è¡Œè„šæœ¬ç”¨çš„ï¼Œå¯ä»¥åˆ©ç”¨å®ƒæ¥å®ç°ç®€å•çš„å·¥ä½œæµã€‚å¦‚æœä¸æ˜¯å¤§å‹çš„é¡¹ç›®ï¼Œä¸å»ºè®®ä½¿ç”¨ gulpï¼Œnpm scripts ä¸€æ ·å¯ä»¥å®Œæˆå·¥ä½œæµè®¾è®¡çš„ä»»åŠ¡ã€‚ä¸‹é¢æ˜¯ React Native é¡¹ç›®é»˜è®¤çš„ scriptsï¼Œå¦‚ä»Šæˆ‘ä»¬å¯ä»¥æŠŠä½¿ç”¨å’Œæ‰©å±• scripts çœ‹åšæ˜¯å‰ç«¯åŸºæœ¬åŠŸã€‚

```json
{
  "scripts": {
    "android": "react-native run-android",
    "ios": "react-native run-ios",
    "start": "react-native start",
    "test": "jest",
    "lint": "eslint ."
  }
}
```

## ä½¿ç”¨ EditorConfig å®ç°è·¨ç¼–è¾‘å™¨ä»£ç é£æ ¼ç»Ÿä¸€

```
# EditorConfig is awesome: http://EditorConfig.org

# top-most EditorConfig file
root = true

# Unix-style newlines with a newline ending every file
[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.md]
trim_trailing_whitespace = false

[*.gradle]
indent_size = 4

[BUCK]
indent_size = 4
```

## ä½¿ç”¨ESLintè§„èŒƒä»£ç 

> ä½œè€…è‡ªå·±å›¢é˜Ÿçš„ ESLint æ–¹æ¡ˆæ˜¯åŸºäº eslint-config-airbnb æ‰©å±•çš„ï¼Œæœ‰å…´è¶£å¯ä»¥ä½“éªŒä¸€ä¸‹ [@sishuguojixuefu/eslint-config](https://github.com/sishuguojixuefu/eslint-config)

### å®‰è£…ä¾èµ–

```sh
# å®‰è£… eslint-config-airbnb åŠå…¶ peerDependencies
$ yarn global add install-peerdeps
$ install-peerdeps -D eslint-config-airbnb
# æ”¯æŒ react-native
$ yarn add -D eslint-plugin-react-native
# æ”¯æŒ typescript
$ yarn add -D @typescript-eslint/parser @typescript-eslint/eslint-plugin eslint-import-resolver-typescript typescript
# æ”¯æŒ prettier
$ yarn add -D prettier eslint-plugin-prettier eslint-config-prettier
# å…¶ä»–
$ yarn add -D eslint-plugin-promise eslint-plugin-you-dont-need-lodash-underscore eslint-plugin-you-dont-need-momentjs
```

### package.json

```json
{
   "eslintConfig": {
    "extends": [
      "airbnb",
      "airbnb/hooks",
      "plugin:react-native/all",
      "plugin:@typescript-eslint/recommended",
      "plugin:promise/recommended",
      "plugin:you-dont-need-lodash-underscore/compatible",
      "plugin:you-dont-need-momentjs/recommended",
      "plugin:prettier/recommended",
      "prettier",
      "prettier/react",
      "prettier/@typescript-eslint"
    ],
    "env": {
      "react-native/react-native": true
    },
    "parser": "@typescript-eslint/parser",
    "parserOptions": {
      "ecmaFeatures": {
        "jsx": true
      }
    },
    "settings": {
      "import/extensions": [".js", ".ts", ".tsx"],
      "import/resolver": {
        "typescript": {
          "alwaysTryTypes": true
        }
      }
    }
  }
}
```

### .prettierrc.js

```js
module.exports = {
  printWidth: 150, // ä¸€è¡Œçš„å­—ç¬¦æ•°ï¼Œå¦‚æœè¶…è¿‡ä¼šè¿›è¡Œæ¢è¡Œï¼Œé»˜è®¤ä¸º80
  tabWidth: 2, // tabç¼©è¿›å¤§å°,é»˜è®¤ä¸º2
  useTabs: false, // ä½¿ç”¨tabç¼©è¿›ï¼Œé»˜è®¤false
  semi: false, // ä½¿ç”¨åˆ†å·, é»˜è®¤true
  /**
   * è¡Œå°¾é€—å·,é»˜è®¤none,å¯é€‰ none|es5|all
   * es5 åŒ…æ‹¬es5ä¸­çš„æ•°ç»„ã€å¯¹è±¡
   * all åŒ…æ‹¬å‡½æ•°å¯¹è±¡ç­‰æ‰€æœ‰å¯é€‰
   */
  trailingComma: 'es5',
  singleQuote: true, // ä½¿ç”¨å•å¼•å·, é»˜è®¤false(åœ¨jsxä¸­é…ç½®æ— æ•ˆ, é»˜è®¤éƒ½æ˜¯åŒå¼•å·)
  /**
   * å¯¹è±¡ä¸­çš„ç©ºæ ¼ é»˜è®¤true
   * true: { foo: bar }
   * false: {foo: bar}
   */
  bracketSpacing: true,
  /**
   * JSXæ ‡ç­¾é—­åˆä½ç½® é»˜è®¤false
   * false:
   * <div
   *  className=""
   *  style={{}}
   * >
   * true:
   * <div
   *  className=""
   * style={{}} >
   */
  jsxBracketSameLine: false,
  /**
   * ç®­å¤´å‡½æ•°å‚æ•°æ‹¬å· é»˜è®¤avoid å¯é€‰ avoid| always
   * avoid èƒ½çœç•¥æ‹¬å·çš„æ—¶å€™å°±çœç•¥ ä¾‹å¦‚x => x
   * always æ€»æ˜¯æœ‰æ‹¬å·
   */
  arrowParens: 'avoid',
  vueIndentScriptAndStyle: false, // vue æ–‡ä»¶ script å’Œ style æ ‡ç­¾ç¼©è¿›ï¼Œé»˜è®¤false
  endOfLine: 'lf', // å¼ºåˆ¶ä½¿ç”¨ unix é£æ ¼çš„æ¢è¡Œç¬¦
}
```

### æ’ä»¶ä»‹ç»

- eslint-config-airbnb: è¯¥è½¯ä»¶åŒ…æä¾› Airbnb çš„ .eslintrc ä½œä¸ºå¯æ‰©å±•çš„å…±äº«é…ç½®
- eslint-plugin-react-native: é’ˆå¯¹ ESLint çš„ React Native ç‰¹å®š linting è§„åˆ™
- @typescript-eslint/parser: å°† TypeScript è½¬æ¢ä¸º ESTreeï¼Œä½¿ eslint å¯ä»¥è¯†åˆ«
- @typescript-eslint/eslint-plugin: ä¸€ä¸ªåŒ…å«ä¸€å †ç‰¹å®šäº TypeScript çš„ ESLint è§„åˆ™çš„æ’ä»¶
- eslint-import-resolver-typescript: ç»™ eslint-plugin-import æ·»åŠ  typescript æ”¯æŒçš„æ’ä»¶
- eslint-plugin-prettier: ä»¥ ESLint æ’ä»¶çš„å½¢å¼è¿è¡Œ prettier
- eslint-config-prettier: å…³é—­æ‰€æœ‰ä¸å¿…è¦æˆ–å¯èƒ½ä¸ prettier çš„è§„åˆ™å†²çªçš„ ESLint è§„åˆ™ã€‚ä¸€å®šè¦æ”¾åˆ°æœ€åã€‚

### vscode eslint plugin config

```json
"editor.codeActionsOnSave": {
  "source.fixAll.eslint": true
},
"eslint.lintTask.enable": true,
"eslint.packageManager": "yarn",
"eslint.alwaysShowStatus": true,
"eslint.validate": [
  "javascript",
  "javascriptreact",
  "typescript",
  "typescriptreact",
  "vue",
  "html"
]
```

## ç”¨ husky å’Œ lint-staged æ„å»ºè¶…æºœçš„ä»£ç æ£€æŸ¥å·¥ä½œæµ

```sh
$ yarn add -D husky
```

```json
{
  "husky": {
    "hooks": {
      "pre-commit": "tsc --noEmit && lint-staged"
    }
  },
  "lint-staged": {
    "**/*.{js,jsx,ts,tsx}": [
      "eslint --fix",
      "git add"
    ],
    "**/*.{md,json}": [
      "prettier --write",
      "git add"
    ]
  }
}
```

## Conventional Commits çº¦å®šå¼æäº¤è§„èŒƒ

[Conventional Commits](https://www.conventionalcommits.org/zh-hans/v1.0.0-beta.4/) æ˜¯ä¸€ç§ç”¨äºç»™æäº¤ä¿¡æ¯å¢åŠ äººæœºå¯è¯»å«ä¹‰çš„è§„èŒƒã€‚çº¦å®šå¼æäº¤è§„èŒƒæ˜¯ä¸€ç§åŸºäºæ¶ˆæ¯çš„è½»é‡çº§çº¦å®šã€‚å®ƒæä¾›äº†ä¸€ç»„ç”¨äºåˆ›å»ºæ¸…æ™°çš„æäº¤å†å²çš„ç®€å•è§„åˆ™ï¼›è¿™ä½¿å¾—ç¼–å†™åŸºäºè§„èŒƒçš„è‡ªåŠ¨åŒ–å·¥å…·å˜å¾—æ›´å®¹æ˜“ã€‚è¿™ä¸ªçº¦å®šä¸ [SemVer](http://semver.org/) ç›¸å»åˆï¼Œåœ¨æäº¤ä¿¡æ¯ä¸­æè¿°æ–°ç‰¹æ€§ã€bug ä¿®å¤å’Œç ´åæ€§å˜æ›´ã€‚

æäº¤è¯´æ˜çš„ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š

```
<ç±»å‹>[å¯é€‰çš„ä½œç”¨åŸŸ]: <æè¿°>

[å¯é€‰çš„æ­£æ–‡]

[å¯é€‰çš„è„šæ³¨]
```

- [conventional-changelog](https://github.com/conventional-changelog): ç”¨äºä»é¡¹ç›®çš„æäº¤æ¶ˆæ¯å’Œå…ƒæ•°æ®ç”Ÿæˆå˜æ›´æ—¥å¿—å’Œå‘è¡Œè¯´æ˜çš„å·¥å…·ã€‚
  - [conventional-changelog-cli](https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-cli): ä»gitå…ƒæ•°æ®ç”Ÿæˆå˜æ›´æ—¥å¿—
  - [commitlint](https://commitlint.js.org/): ğŸ““ Lint commit messages
